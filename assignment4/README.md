##Assignment 4 - Custom Writable

__Goals:__

In Assignment 4, we are going to implement a custom class that holds the data used and output by the WordStatistics program. In particular, we want to solve a common big data processing scenario - We run a data/statistics collection program at some regular interval (hourly, daily, weekly), and we want to aggregate those statistics for longer time periods (daily, weekly, monthly) without reprocessing the original data (email, in our case).

To accomplish this, first modify your WordStatistics program from Assignment 2 to output the counts for each word as well as the computed statistics (mean, variance).

The output in Assignment 2 was:

* word
* tab
* document count, mean, variance

The output of your modified WordStatistics program in Assignment 4 should be:

* word
* tab
* document count, total count, sum of squares, mean, variance

The document count, total count, and sum or squares are longs, and mean and variance are doubles.  Each output line should look like this:

also\t5,8,20,1.6,1.4399999999999995

where "\t" is a tab character, and the numeric values are comma separated (to be correct, your output should be in this format).

To make this change, implement a class (call it WordStatisticsWritable) that implements the Writable interface and contains all these numbers (counts and statistics) and use it in your version of WordStatistics for Assignment 4.

 

You'll then implement a second map-reduce job (call it WordStatisticsAggregator) that takes multiple files output by the new WordStatistics program and

aggregates the counts for the same words, and
computes new statistics (mean and variance) for the updated/aggregated counts.
outputs the updated counts and statistics for each word.
 

Major Hints:

Declaration of the map class for WordStatistics should look like this:

... MapClass extends Mapper<LongWritable, Text, Text, WordStatisticsWritable>

Declaration of the reduce class for WordStatistics should look like this:

... ReducerClass extends Reducer<Text, WordStatisticsWritable, Text, WordStatisticsWritable>

Declaration of the map class for WordStatisticsAggregator should look like this:

... MapClass extends Mapper<Text, Text, Text, WordStatisticsWritable>

Declaration of the reduce class for WordStatisticsAggregator should look like this:

... ReducerClass extends Reducer<Text, WordStatisticsWritable, Text, WordStatisticsWritable>

By the time you complete this assignment you should understand (if you don't already) why these declarations use the type parameters they do, and how they correspond to settings made in main().

 

Requirements:

Implement a custom class for WordStatistics that implements the Writable interface and contains all the numbers (counts, statistics). Call this class WordStatisticsWritable, and use as the value type in WordStatistics reducer input and output and WordStatisticsAggregator reducer input and output (see hints above).
Use KeyValueTextInputFormat in place of TextInputFormat in your implementation of WordStatisticsAggregator.
WordStatisticsAggregator should output a file in the same format as the output of WordStatistics, so it could be input to another run of WordStatisticsAggregator. The output should be formatted as described above (tab between the word and the numeric values, and the numeric values should be comma separated).
 

Input files to WordStatistics (process these two files in separate runs of WordStatistics:

dataSet3a.txt
dataSet3b.txt
 

Input files to WordCountAggregator:

The output files from the two runs of WordStatistics (one run processed dataSet3a.txt, the second run processed dataSet3b.txt) 
When setting up the AWS job step for the aggregator job, specify the input files separated by a comma, like this:

s3n://utcs378/yourID/output/assign4-dataSet3a/part-r-00000,s3n://utcs378/yourID/output/assign4-dataSet3b/part-r-00000

To read multiple input files, you'll need to make this change in the main() method of WordStatisticsAggregator (I suggest you use this in all future mapReduce programs):

// Grab the input file and output directory from the command line. 
String[] inputPaths = appArgs[0].split(","); 
for ( String inputPath : inputPaths ) { 
  FileInputFormat.addInputPath(job, new Path(inputPath)); 
}

in place of what we used previously,

FileInputFormat.addInputPath(job, new Path(appArgs[0]));

 

Artifacts to submit for this assignment:

Assignment4Build.zip - Java code (in the directory structure recognized by the pom.xml file), and pom.xml.
Assignment4Code.zip - Java code (all Java files in one directory).
Assignment4Output.txt - output generated by your solution (only the output from WordStatisticsAggregator), in the format described above.
 

Bonus: (2 points) write a single reducer class that can be used for the combiner and reducer for WordStatistics and the combiner and reducer for WordStatisticsAggregator.